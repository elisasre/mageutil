<!-- Code generated by gomarkdoc. DO NOT EDIT -->

# mageutil

```go
import "github.com/elisasre/mageutil"
```

package mageutil provides util functions for [Magefile](<https://magefile.org/>). For usage please refer to [documentation](<https://magefile.org/importing/>) provided by Magefile.

## Index

- [Constants](<#constants>)
- [func Build\(ctx context.Context, name string\) error](<#Build>)
- [func BuildAll\(ctx context.Context\) error](<#BuildAll>)
- [func BuildFor\(ctx context.Context, goos, goarch, name string\) error](<#BuildFor>)
- [func BuildForArmMac\(ctx context.Context, name string\) error](<#BuildForArmMac>)
- [func BuildForLinux\(ctx context.Context, name string\) error](<#BuildForLinux>)
- [func BuildForMac\(ctx context.Context, name string\) error](<#BuildForMac>)
- [func CGO\(enabled bool\)](<#CGO>)
- [func Clean\(ctx context.Context\) error](<#Clean>)
- [func CoverInfo\(ctx context.Context, profile string\) error](<#CoverInfo>)
- [func DefaultLabels\(title, url, desc string\) map\[string\]string](<#DefaultLabels>)
- [func Docker\(ctx context.Context, args ...string\) error](<#Docker>)
- [func DockerBuild\(ctx context.Context, platform, dockerfile, buildCtx string, tags \[\]string, extraCtx, labels map\[string\]string\) error](<#DockerBuild>)
- [func DockerBuildDefault\(ctx context.Context, name, url string, tags \[\]string\) error](<#DockerBuildDefault>)
- [func Git\(ctx context.Context, args ...string\) error](<#Git>)
- [func Go\(ctx context.Context, args ...string\) error](<#Go>)
- [func GoList\(ctx context.Context, target string\) \(\[\]string, error\)](<#GoList>)
- [func GoV\(\)](<#GoV>)
- [func GoWith\(ctx context.Context, env map\[string\]string, args ...string\) error](<#GoWith>)
- [func GolangCILint\(ctx context.Context, args ...string\) error](<#GolangCILint>)
- [func IntegrationTest\(ctx context.Context, pkg string\) error](<#IntegrationTest>)
- [func LicenseCheck\(ctx context.Context, w io.Writer, targets ...string\) error](<#LicenseCheck>)
- [func LintAll\(ctx context.Context\) error](<#LintAll>)
- [func MergeCover\(ctx context.Context, coverFiles \[\]string, w io.Writer\) error](<#MergeCover>)
- [func MergeCoverProfiles\(ctx context.Context\) error](<#MergeCoverProfiles>)
- [func MustSetEnv\(k, v string\)](<#MustSetEnv>)
- [func Run\(ctx context.Context, name string, args ...string\) error](<#Run>)
- [func Targets\(ctx context.Context\) \(\[\]string, error\)](<#Targets>)
- [func UnitTest\(ctx context.Context\) error](<#UnitTest>)
- [func Verbose\(enabled bool\)](<#Verbose>)
- [func VulnCheck\(ctx context.Context, args ...string\) error](<#VulnCheck>)
- [func VulnCheckAll\(ctx context.Context\) error](<#VulnCheckAll>)


## Constants

<a name="OCILabelTitle"></a>

```go
const (
    OCILabelTitle       = "org.opencontainers.image.title"
    OCILabelURL         = "org.opencontainers.image.url"
    OCILabelVersion     = "org.opencontainers.image.version"
    OCILabelDescription = "org.opencontainers.image.description"
    OCILabelCreated     = "org.opencontainers.image.created"
    OCILabelSource      = "org.opencontainers.image.source"
    OCILabelLicenses    = "org.opencontainers.image.licenses"
    OCILabelAuthors     = "org.opencontainers.image.authors"
    OCILabelVendor      = "org.opencontainers.image.vendor"
    OCILabelRevision    = "org.opencontainers.image.revision"
)
```

<a name="DefaultImageTagPrefix"></a>

```go
const (
    DefaultImageTagPrefix = "quay.io/elisaoyj/sre-"
    DefaultPlatform       = "linux/amd64"
    DefaultDockerfile     = "Dockerfile"
    DefaultBuildCtx       = "."
    DefaultExtraCtx       = BinDir + "linux/amd64/"
)
```

<a name="GoVersion"></a>

```go
const (
    GoVersion = "go1.20.5"
    CmdDir    = "./cmd/"
    TargetDir = "./target/"
    BinDir    = TargetDir + "bin/"
)
```

<a name="UnitCoverProfile"></a>

```go
const (
    UnitCoverProfile        = TargetDir + "reports/unit-test-coverage.out"
    IntegrationCoverProfile = TargetDir + "reports/integration-test-coverage.out"
    MergedCoverProfile      = TargetDir + "reports/merged-test-coverage.out"
)
```

<a name="UNKNOWN"></a>

```go
const (
    UNKNOWN = "Unknown"
)
```

<a name="Build"></a>
## func [Build](<https://github.com/elisasre/mageutil/blob/main/go.go#L75>)

```go
func Build(ctx context.Context, name string) error
```

Build binary using settings from system env.

<a name="BuildAll"></a>
## func [BuildAll](<https://github.com/elisasre/mageutil/blob/main/go.go#L61>)

```go
func BuildAll(ctx context.Context) error
```

BuildAll binaries for targets returned by utils.Targets using utils.Build.

<a name="BuildFor"></a>
## func [BuildFor](<https://github.com/elisasre/mageutil/blob/main/go.go#L90>)

```go
func BuildFor(ctx context.Context, goos, goarch, name string) error
```

BuildDefault binary using settings from system env.

<a name="BuildForArmMac"></a>
## func [BuildForArmMac](<https://github.com/elisasre/mageutil/blob/main/go.go#L111>)

```go
func BuildForArmMac(ctx context.Context, name string) error
```

BuildForArmMac builds binary for arm64 based mac systems.

<a name="BuildForLinux"></a>
## func [BuildForLinux](<https://github.com/elisasre/mageutil/blob/main/go.go#L101>)

```go
func BuildForLinux(ctx context.Context, name string) error
```

BuildForLinux builds binary for amd64 based linux systems.

<a name="BuildForMac"></a>
## func [BuildForMac](<https://github.com/elisasre/mageutil/blob/main/go.go#L106>)

```go
func BuildForMac(ctx context.Context, name string) error
```

BuildForMac builds binary for amd64 based mac systems.

<a name="CGO"></a>
## func [CGO](<https://github.com/elisasre/mageutil/blob/main/env.go#L23>)

```go
func CGO(enabled bool)
```

CGO can be used to enable of disable CGO. By default this package will disable CGO.

<a name="Clean"></a>
## func [Clean](<https://github.com/elisasre/mageutil/blob/main/git.go#L15>)

```go
func Clean(ctx context.Context) error
```

Clean removes all files ignored by git.

<a name="CoverInfo"></a>
## func [CoverInfo](<https://github.com/elisasre/mageutil/blob/main/testing.go#L88>)

```go
func CoverInfo(ctx context.Context, profile string) error
```

CoverInfo prints function level cover stats from given profile.

<a name="DefaultLabels"></a>
## func [DefaultLabels](<https://github.com/elisasre/mageutil/blob/main/docker.go#L68>)

```go
func DefaultLabels(title, url, desc string) map[string]string
```

DefaultLabels provides labels for Elisa SoSe/SRE organization.

<a name="Docker"></a>
## func [Docker](<https://github.com/elisasre/mageutil/blob/main/docker.go#L32>)

```go
func Docker(ctx context.Context, args ...string) error
```

Docker runs systems docker cmd with given args.

<a name="DockerBuild"></a>
## func [DockerBuild](<https://github.com/elisasre/mageutil/blob/main/docker.go#L51>)

```go
func DockerBuild(ctx context.Context, platform, dockerfile, buildCtx string, tags []string, extraCtx, labels map[string]string) error
```

DockerBuild is a short hand for docker buildx build with saine default flags

<a name="DockerBuildDefault"></a>
## func [DockerBuildDefault](<https://github.com/elisasre/mageutil/blob/main/docker.go#L37>)

```go
func DockerBuildDefault(ctx context.Context, name, url string, tags []string) error
```

DockerBuildDefault build image with sane defaults.

<a name="Git"></a>
## func [Git](<https://github.com/elisasre/mageutil/blob/main/git.go#L10>)

```go
func Git(ctx context.Context, args ...string) error
```

Git is shorthand for git executable provided by system.

<a name="Go"></a>
## func [Go](<https://github.com/elisasre/mageutil/blob/main/go.go#L27>)

```go
func Go(ctx context.Context, args ...string) error
```

Go is shorthand for go executable provided by system.

<a name="GoList"></a>
## func [GoList](<https://github.com/elisasre/mageutil/blob/main/go.go#L122>)

```go
func GoList(ctx context.Context, target string) ([]string, error)
```

GoList lists all packages in given target.

<a name="GoV"></a>
## func [GoV](<https://github.com/elisasre/mageutil/blob/main/go.go#L34>)

```go
func GoV()
```

GoV prints wanted go version. Currently this is hardcoded in this library but in in go1.21.0 this could be defined by toolchain directive in go.mod file. So once go1.21 is out this has to be revised.

<a name="GoWith"></a>
## func [GoWith](<https://github.com/elisasre/mageutil/blob/main/go.go#L39>)

```go
func GoWith(ctx context.Context, env map[string]string, args ...string) error
```

GoWith is shorthand for go executable provided by system.

<a name="GolangCILint"></a>
## func [GolangCILint](<https://github.com/elisasre/mageutil/blob/main/lint.go#L18>)

```go
func GolangCILint(ctx context.Context, args ...string) error
```

LintNative imports golangci\-lint and runs it as a helper library.

<a name="IntegrationTest"></a>
## func [IntegrationTest](<https://github.com/elisasre/mageutil/blob/main/testing.go#L34>)

```go
func IntegrationTest(ctx context.Context, pkg string) error
```

IntegrationTest executes all tests in given pkg with default flags.

<a name="LicenseCheck"></a>
## func [LicenseCheck](<https://github.com/elisasre/mageutil/blob/main/licenses.go#L20>)

```go
func LicenseCheck(ctx context.Context, w io.Writer, targets ...string) error
```

LicenseCheck runs github.com/google/go\-licenses/licenses for given targets and writes toe output into w.

<a name="LintAll"></a>
## func [LintAll](<https://github.com/elisasre/mageutil/blob/main/lint.go#L13>)

```go
func LintAll(ctx context.Context) error
```

LintAll uses golangci\-lint library to lint all go files.

<a name="MergeCover"></a>
## func [MergeCover](<https://github.com/elisasre/mageutil/blob/main/testing.go#L52>)

```go
func MergeCover(ctx context.Context, coverFiles []string, w io.Writer) error
```

MergeCover merges multiple go test \-cover profiles and writes the combined coverage into out.

coverage merging is adapted from https://github.com/wadey/gocovmerge

<a name="MergeCoverProfiles"></a>
## func [MergeCoverProfiles](<https://github.com/elisasre/mageutil/blob/main/testing.go#L72>)

```go
func MergeCoverProfiles(ctx context.Context) error
```

MergeCoverProfiles merges default unit and integration cover profile.

<a name="MustSetEnv"></a>
## func [MustSetEnv](<https://github.com/elisasre/mageutil/blob/main/env.go#L31>)

```go
func MustSetEnv(k, v string)
```



<a name="Run"></a>
## func [Run](<https://github.com/elisasre/mageutil/blob/main/go.go#L116>)

```go
func Run(ctx context.Context, name string, args ...string) error
```

Run builds and executes app binary from default path.

<a name="Targets"></a>
## func [Targets](<https://github.com/elisasre/mageutil/blob/main/go.go#L45>)

```go
func Targets(ctx context.Context) ([]string, error)
```

Targets returns list of main pkgs under utils.CmdDir.

<a name="UnitTest"></a>
## func [UnitTest](<https://github.com/elisasre/mageutil/blob/main/testing.go#L23>)

```go
func UnitTest(ctx context.Context) error
```

UnitTest executes all unit tests with default flags.

<a name="Verbose"></a>
## func [Verbose](<https://github.com/elisasre/mageutil/blob/main/env.go#L18>)

```go
func Verbose(enabled bool)
```

Verbose can be used to control mage's verbose state. By default this package will set mage in verbose state.

<a name="VulnCheck"></a>
## func [VulnCheck](<https://github.com/elisasre/mageutil/blob/main/vulncheck.go#L10>)

```go
func VulnCheck(ctx context.Context, args ...string) error
```

VulnChek runs golang.org/x/vuln/scan with given args.

<a name="VulnCheckAll"></a>
## func [VulnCheckAll](<https://github.com/elisasre/mageutil/blob/main/vulncheck.go#L20>)

```go
func VulnCheckAll(ctx context.Context) error
```

VulnChek runs golang.org/x/vuln/scan for all packages.

Generated by [gomarkdoc](<https://github.com/princjef/gomarkdoc>)
